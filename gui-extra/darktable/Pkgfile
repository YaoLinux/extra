makedepends=(exiv2 iso-codes libwebp llvm lcms2 lensfun desktop-file-utils curl libsecret libgphoto2 openexr sqlite libxslt libsoup gtk3 pugixml json-glib lua colord colord-gtk graphicsmagick intltool cmake librsvg flickcurl)

description="Utility to organize and develop raw images"
url="http://darktable.sf.net/"
packager="Yaolinux Team"
maintainer="rems"

name=darktable
version=3.2.1

source=(https://github.com/darktable-org/darktable/releases/download/release-${version}/darktable-${version/rc/.rc}.tar.xz)


build() {

  mkdir -p build && cd build
  
  cmake \
      -DCMAKE_INSTALL_PREFIX=/usr \
      -DCMAKE_INSTALL_LIBDIR=/usr/lib \
      -DCMAKE_BUILD_TYPE=Release \
      -DBINARY_PACKAGE_BUILD=1 \
      -DBUILD_USERMANUAL=False \
      -DUSE_LIBSECRET=On \
      -DUSE_LUA=On \
      -DUSE_COLORD=On \
      -DPROJECT_VERSION=$version \
      ../$name-${version/rc/~rc}

  make
}

package() {

  cd build

  make DESTDIR=$PKG install
  ln -s darktable/libdarktable.so $PKG/usr/lib/libdarktable.so
}
