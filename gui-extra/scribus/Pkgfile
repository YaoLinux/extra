makedepends=(icu cmake aspell cups qttools qtdeclarative gnutls kerberos boost ghostscript lcms2 libxml2 cairo desktop-file-utils shared-mime-info poppler podofo libfreehand libcdr libmspub libpagemaker libwpg libqxp libvisio libzmf)

description="Desktop publishing software"
url="http://www.scribus.net"

packager="Yaolinux Team"
maintainer="rems"

name=scribus
version=1.5.6.1
release=3

run=(shared-mime-info)

source=(http://rems.6admin.net/sources/development/scribus-1.5.5.tar.xz
        https://github.com/scribusproject/scribus/commit/17d6a983.patch)

build() {

mv -v 17d6a983.patch scribus-qt-5.15.patch

	cd $name-$version

patch -p1 -i ../scribus-qt-5.15.patch # Fix build with Qt 5.15

# Fix python name
    sed -e 's|#!/usr/bin/python|#!/usr/bin/python2|' \
        -e 's|#!/usr/bin/env python|#!/usr/bin/env python2|' \
        -i scribus/plugins/scriptplugin/{samples,scripts}/*

	mkdir ../build && cd ../build

        cmake ../$name-$version \
	      -DCMAKE_INSTALL_PREFIX=/usr \
              -DCMAKE_SKIP_RPATH=ON \
              -DCMAKE_BUILD_TYPE=None

        make
	make DESTDIR=$PKG install
}
