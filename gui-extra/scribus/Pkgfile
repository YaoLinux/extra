makedepends=(icu cmake boost aspell cups qttools qtdeclarative gnutls kerberos boost ghostscript lcms2 libxml2 cairo desktop-file-utils shared-mime-info poppler podofo)

description="Desktop publishing software"
url="http://www.scribus.net"

packager="Yaolinux Team"
maintainer="rems"

name=scribus
version=1.5.5

run=(shared-mime-info)

source=(https://downloads.sourceforge.net/${name}/${name}-${version}.tar.xz)

build() {
	cd $name-$version

# Fix python name
    sed -e 's|#!/usr/bin/python|#!/usr/bin/python2|' \
        -e 's|#!/usr/bin/env python|#!/usr/bin/env python2|' \
        -i scribus/plugins/scriptplugin/{samples,scripts}/*
        
	mkdir ../build && cd ../build

        cmake ../$name-$version \
	      -DCMAKE_INSTALL_PREFIX=/usr \
              -DCMAKE_SKIP_RPATH=ON \
              -DCMAKE_BUILD_TYPE=None

        make
	make DESTDIR=$PKG install

        install -Dm644 $SRC/$name-$version/scribus.desktop \
	$PKG/usr/share/applications/scribus.desktop
	
	for i in 16x16 32x32 128x128 256x256 512x512 1024x1024
    do
        install -Dm644 resources/iconsets/artwork/icon_${i}.png \
	               "${PKG}"/usr/share/icons/hicolor/${i}/apps/scribus.png
    done
}
